<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quran Quiz</title>
      <script src="https://www.gstatic.com/firebasejs/8.3.3/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.3/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.3.3/auth.js"></script>
    <link rel="shortcut icon" href="../images/logo.png" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@400;700&family=Noto+Sans+Display:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans Display', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #f8f9fa;
        }
        .arabic-text {
            font-family: 'Noto Sans Arabic', Tahoma, sans-serif;
            font-size: 1.2em;
            line-height: 2.8;
            direction: rtl;
            text-align: right;
            padding: 10px;
            background-color: #eef2ff;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        .quiz-container {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .question-card {
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #e9ecef;
            border-radius: 8px;
        }
        .result-container {
            display: none;
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }
        .submit-btn {
            background-color: #6f42c1;
            color: white;
            padding: 10px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .submit-btn:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        .submit-btn:hover:not(:disabled) {
            background-color: #5a2d91;
        }
        .progress {
            height: 25px;
            margin-bottom: 20px;
        }
        .loading-spinner {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }
                /* üåê Navbar + Dropdown Styling */

/* Dropdown Container */
.dropdown {
  position: relative;
  display: inline-block;
  font-family: 'Segoe UI', Arial, sans-serif;
}

/* Dropdown Button */
.dropbtn {
  background: #24292e;
  color: #fff;
  padding: 10px 18px;
  border: none;
  cursor: pointer;
  font-size: 15px;
  border-radius: 6px;
  transition: background 0.3s ease;
  font-weight: 500;
}

.dropbtn:hover {
  background: #2f363d;
}

/* Dropdown Menu Box */
.dropdown-content {
  display: none;
  position: absolute;
  min-width: 220px;
  background: #fff;
  border: 1px solid #e1e4e8;
  border-radius: 8px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.15);
  opacity: 0;
  transform: translateY(12px);
  transition: opacity 0.3s ease, transform 0.3s ease;
  z-index: 100;
  overflow: hidden;
}

/* Dropdown Links */
.dropdown-content a {
  color: #24292e;
  padding: 12px 16px;
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 14px;
  text-decoration: none;
  font-weight: 500;
  transition: background 0.2s ease, padding-left 0.2s ease;
}

/* Optional Hover Effect */
.dropdown-content a:hover {
  background: #f6f8fa;
  padding-left: 22px;
}

/* Small Icons beside text */
.dropdown-content a .icon {
  font-size: 16px;
}

/* Divider inside dropdown */
.dropdown-content hr {
  border-top: 1px solid #e1e4e8;
}

/* Dropdown hover animation */
.dropdown:hover .dropdown-content {
  display: block;
  opacity: 1;
  animation: 1s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0s 1 normal both running slide-in-top;
  transition: opacity 2s ease, transform 2s ease;
  transform: translateY(0);
}

/* Optional animation keyframes (if you want smooth slide) */
@keyframes slide-in-top {
  0% {
    transform: translateY(-10px);
    opacity: 0;
  }
  100% {
    transform: translateY(0);
    opacity: 1;
  }
}
/* animaton effect */
/* ----------------------------------------------
 * Generated by Animista on 2025-10-8 14:21:31
 * Licensed under FreeBSD License.
 * See http://animista.net/license for more info. 
 * w: http://animista.net, t: @cssanimista
 * ---------------------------------------------- */

@-webkit-keyframes slide-in-fwd-top{0%{-webkit-transform:translateZ(-1400px) translateY(-800px);transform:translateZ(-1400px) translateY(-800px);opacity:0}100%{-webkit-transform:translateZ(0) translateY(0);transform:translateZ(0) translateY(0);opacity:1}}@keyframes slide-in-fwd-top{0%{-webkit-transform:translateZ(-1400px) translateY(-800px);transform:translateZ(-1400px) translateY(-800px);opacity:0}100%{-webkit-transform:translateZ(0) translateY(0);transform:translateZ(0) translateY(0);opacity:1}}
body{-webkit-animation:slide-in-fwd-top .4s cubic-bezier(.25,.46,.45,.94) both;animation:slide-in-fwd-top .4s cubic-bezier(.25,.46,.45,.94) both}

    </style>
</head>
<body>
        <!-- navbar -->
<nav class="navbar navbar-expand-lg bg-primary px-5">
  <div class="container-fluid">
    <img src="../images/logo.png" hight="50px" width="50px" style="border-radius: 50%; margin-right: 10px;" alt="">
    <a class="navbar-brand" href="#" style="font-weight: bold ;">Hwquranacademy</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
        <li style="list-style: none; margin-bottom: 10px; margin-right: 10px;" class="nav-item">
        <a class="mt-2 nav-link text-white" href="../main pages/html/index.html">Home</a>
      </li>
      <li style="list-style: none; margin-bottom: 10px; margin-right: 10px;" class="nav-item">
        <a class="mt-2 nav-link text-white" href="../duas/dua.html">ü§≤Dua (Prayer)</a>
      </li>

      <ul class="navbar-nav">
        <div class="dropdown mx-2">
          <button class="dropbtn my-2">Grammer & Translation</button>

          <div class="dropdown-content">
            <a href="grammer.html
              ">Arabic Grammer</a>
            <a href="tarjuma.html"> Translation</a>
          </div>
        </div>
        <div class="dropdown mx-2">
          <button class="dropbtn my-2">Pages</button>
          <div class="dropdown-content">
            <a href="../main pages/html/contact.html">Contact</a>
            <a href="../main pages/html/about.html"> About</a>
          </div>
        </div>
        <div class="dropdown mx-2">
          <button class="dropbtn my-2">Learning</button>
          <div class="dropdown-content">
            <a href="../login/html/t.html" class="mt-2 mx-2"><i class="icon">üë®‚Äçüè´</i> Teacher</a>
            <a href="../login/html/s.html" class="mt-2 mx-2"><i class="icon">üë§</i> Student</a>
            <a href="../stories/main.html" class="mt-2 mx-2"><i class="icon">üìö</i> Prophet Stories</a>
          </div>
        </div>
        <div class="dropdown mx-2">
          <button class="dropbtn my-2">Allah & Prophet SAW names</button>

          <div class="dropdown-content">
            <a href="../allah and saw name/allah name.html
              ">Allah names</a>
            <a href="../allah and saw name/saw.html">Prophet SAW names</a>
          </div>
        </div>
        <li class="nav-item" id="login">
          <a class="mt-2 nav-link text-white" href="../mlogin.html"><i class="icon">üîë</i> Login</a>
        </li>


      </ul>
    </div>
  </div>
</nav>
    <div class="container mt-4">
        <header class="text-center mb-4">
            <h1 class="text-primary">Quran Quiz</h1>
            <p class="lead">Test Your Knowledge</p>
            <a href="tarjuma.html" class="btn btn-secondary">‚Üê Back to Surahs</a>
        </header>

        <div class="quiz-container">
            <h2 class="mb-4">Test Your Knowledge</h2>
            <div class="row mb-4">
                <div class="col-md-6">
                    <h4>Select Surah for Quiz</h4>
                    <select id="quizSurahDropdown" class="form-select">
                        <option value="">-- Select Surah --</option>
                    </select>
                </div>
            </div>
            <div id="quizContent">
                <p>Please select a Surah from the dropdown above to generate a quiz.</p>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- DOM Elements ---
            const quizSurahDropdown = document.getElementById('quizSurahDropdown');
            const quizContent = document.getElementById('quizContent');

            // --- State ---
            let selectedLanguage = localStorage.getItem('selectedQuranLanguage');
            let allSurahs = [];

            // --- API ---
            const API_BASE = 'https://api.alquran.cloud/v1/';
            const languageEditionMap = {
                'en': 'en.sahih',
                'ur': 'ur.junagarhi',
                'hi': 'hi.hindi',
                'bn': 'bn.bengali',
                'tr': 'tr.sadi',
                'fa': 'fa.ayati',
                'es': 'es.cortes',
                'fr': 'fr.hamidullah',
                'id': 'id.indonesian',
                'ms': 'ms.basmeih'
            };
            
            // --- Initialization ---
            if (!selectedLanguage) {
                quizContent.innerHTML = `<p class="text-warning">Language not selected. Please go back and select a language first.</p>`;
                return;
            }

            initializeApp();

            async function initializeApp() {
                try {
                    const response = await fetch(`${API_BASE}surah`);
                    const data = await response.json();
                    allSurahs = data.data;
                    populateSurahDropdown();
                } catch (error) {
                    console.error("Failed to load Surah list:", error);
                    quizContent.innerHTML = `<p class="text-danger">Failed to load Surah list. Please check your internet connection.</p>`;
                }
            }

            // --- Populate UI Elements ---
            function populateSurahDropdown() {
                const optionsHtml = allSurahs.map(surah => 
                    `<option value="${surah.number}">${surah.number}. ${surah.englishName}</option>`
                ).join('');
                quizSurahDropdown.innerHTML = '<option value="">-- Select Surah --</option>' + optionsHtml;
            }

            // --- Event Listener for Dropdown ---
            quizSurahDropdown.addEventListener('change', (e) => {
                if (e.target.value) {
                    generateQuiz(parseInt(e.target.value));
                }
            });

            // --- Quiz Generation ---
            async function generateQuiz(surahNumber) {
                quizContent.innerHTML = `<div class="loading-spinner"><div class="spinner-border text-primary" role="status"></div></div>`;
                
                try {
                    const edition = languageEditionMap[selectedLanguage];
                    const response = await fetch(`${API_BASE}surah/${surahNumber}/${edition}`);
                    const data = await response.json();
                    const surahData = data.data;
                    const quizQuestions = createQuizQuestions(surahData);
                    displayQuiz(quizQuestions, surahData);
                } catch (error) {
                    console.error("Failed to load Surah for quiz:", error);
                    quizContent.innerHTML = `<p class="text-danger">Failed to load Surah for quiz.</p>`;
                }
            }
            
            // --- Dynamic Quiz Creation ---
            function createQuizQuestions(surah) {
                const questions = [];
                const totalVerses = surah.numberOfAyahs;

                // Determine the number of questions based on Surah length
                let questionCount = 6; // Default for short Surahs
                if (totalVerses > 100) {
                    questionCount = 15; // For long Surahs
                } else if (totalVerses > 25) {
                    questionCount = 10; // For medium Surahs
                }

                // Q1: Meaning of the name
                questions.push({
                    question: `What is the meaning of the name "${surah.englishName}"?`,
                    options: [surah.englishNameTranslation, "The Opening", "The Guidance", "The Mercy"],
                    correctAnswer: 0
                });
                // Q2: Revelation Place
                questions.push({
                    question: `Where was Surah ${surah.englishName} revealed?`,
                    options: ["Makkah", "Madinah", "Jerusalem", "Mount Sinai"],
                    correctAnswer: surah.revelationType === "Meccan" ? 0 : 1
                });
                // Q3: Number of Verses
                const correctVerseCount = surah.numberOfAyahs;
                const verseOptions = [correctVerseCount, correctVerseCount + 1, correctVerseCount - 1, correctVerseCount + 2].filter(v => v > 0);
                questions.push({
                    question: `How many verses (Ayahs) are in Surah ${surah.englishName}?`,
                    options: verseOptions,
                    correctAnswer: verseOptions.indexOf(correctVerseCount)
                });

                // Generate remaining questions (verse identification or phrase identification)
                for (let i = 3; i < questionCount; i++) {
                    const randomAyah = surah.ayahs[Math.floor(Math.random() * surah.ayahs.length)];
                    
                    // Alternate between "Identify Surah" and "Identify Verse Number" for longer quizzes
                    if (i % 2 === 0 || totalVerses <= 25) {
                        // Question: In which Surah is this verse?
                        const otherSurahs = allSurahs.filter(s => s.number !== surah.number);
                        const distractors = [];
                        for(let j=0; j<3; j++) {
                            const randomSurah = otherSurahs[Math.floor(Math.random() * otherSurahs.length)];
                            distractors.push(randomSurah.englishName);
                        }
                        const options = [surah.englishName, ...distractors].sort(() => Math.random() - 0.5);
                        questions.push({
                            question: `<div class="arabic-text">${randomAyah.text}</div><br>In which Surah is this verse found?`,
                            options: options,
                            correctAnswer: options.indexOf(surah.englishName)
                        });
                    } else {
                        // Question: In which verse number is this phrase?
                        const phrase = randomAyah.text.split(' ').slice(0, 4).join(' '); // Take first 4 words as phrase
                        const correctVerseNum = randomAyah.numberInSurah;
                        const verseNumOptions = [correctVerseNum];
                        while(verseNumOptions.length < 4) {
                            const randomNum = Math.floor(Math.random() * totalVerses) + 1;
                            if (!verseNumOptions.includes(randomNum)) {
                                verseNumOptions.push(randomNum);
                            }
                        }
                        verseNumOptions.sort((a,b) => a - b);
                        questions.push({
                            question: `<div class="arabic-text">${phrase}...</div><br>In which verse number of Surah ${surah.englishName} does this phrase appear?`,
                            options: verseNumOptions,
                            correctAnswer: verseNumOptions.indexOf(correctVerseNum)
                        });
                    }
                }
                return questions;
            }

            function displayQuiz(questions, surah) {
                const quizHtml = `
                    <h3>Quiz: ${surah.englishName}</h3>
                    <div class="progress">
                        <div class="progress-bar" id="quizProgress" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0% Answered</div>
                    </div>
                    <div id="quizQuestionsContainer">
                        ${questions.map((q, index) => `
                            <div class="question-card">
                                <h5>Question ${index + 1}</h5>
                                <p>${q.question}</p>
                                ${q.options.map((option, i) => `
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="quizQuestion${index}" id="q${index}o${i}" value="${i}">
                                        <label class="form-check-label" for="q${index}o${i}">${option}</label>
                                    </div>
                                `).join('')}
                            </div>
                        `).join('')}
                    </div>
                    <div class="text-center mt-4">
                        <button id="submitQuizBtn" class="submit-btn" disabled>Submit Quiz</button>
                    </div>
                    <div id="quizResult" class="result-container"></div>
                `;
                quizContent.innerHTML = quizHtml;
                setupQuizLogic(questions);
            }

            function setupQuizLogic(questions) {
                const submitBtn = document.getElementById('submitQuizBtn');
                const resultContainer = document.getElementById('quizResult');
                const progressBar = document.getElementById('quizProgress');
                const totalQuestions = questions.length;

                function checkAllQuestionsAnswered() {
                    let allAnswered = true;
                    let answeredCount = 0;
                    for (let i = 0; i < totalQuestions; i++) {
                        const answered = document.querySelector(`input[name="quizQuestion${i}"]:checked`);
                        if (!answered) {
                            allAnswered = false;
                        } else {
                            answeredCount++;
                        }
                    }
                    submitBtn.disabled = !allAnswered;
                    const progressPercent = (answeredCount / totalQuestions) * 100;
                    progressBar.style.width = progressPercent + '%';
                    progressBar.setAttribute('aria-valuenow', progressPercent);
                    progressBar.textContent = `${Math.round(progressPercent)}% Answered`;
                }

                document.querySelectorAll('#quizQuestionsContainer input[type="radio"]').forEach(radio => {
                    radio.addEventListener('change', checkAllQuestionsAnswered);
                });

                submitBtn.addEventListener('click', () => {
                    let score = 0;
                    questions.forEach((q, index) => {
                        const selectedAnswer = document.querySelector(`input[name="quizQuestion${index}"]:checked`);
                        if (selectedAnswer && parseInt(selectedAnswer.value) === q.correctAnswer) {
                            score++;
                        }
                    });

                    resultContainer.style.display = 'block';
                    resultContainer.innerHTML = `
                        <h3>Your Result</h3>
                        <p>You scored <strong>${score}</strong> out of <strong>${totalQuestions}</strong>.</p>
                        <p>Percentage: <strong>${Math.round((score / totalQuestions) * 100)}%</strong></p>
                    `;
                    document.querySelectorAll('#quizQuestionsContainer input[type="radio"]').forEach(input => input.disabled = true);
                    submitBtn.style.display = 'none';
                });
            }
        });
    </script>
    <footer style="margin-top: 200px; background-color:#0d0d0d; color:#fff; font-family:'Segoe UI',Arial,sans-serif; padding:60px 20px 20px; border-top:3px solid #0d6efd; box-shadow:0 -3px 15px rgba(0,0,0,0.3);">
  <div class="container" style="max-width:1200px; margin:0 auto;">
    <div class="row" style="display:flex; flex-wrap:wrap; justify-content:space-between; gap:30px;">

      <!-- Logo & About -->
      <div style="flex:1 1 250px; min-width:220px;">
        <h2 style="font-weight:700; color:#0d6efd;">Hw Quran Academy</h2>
        <p style="color:#aaa; line-height:1.8; margin-top:15px;">
          A global online platform to learn <strong>Quran, Arabic Grammar</strong>, and Islamic knowledge with 
          qualified teachers. Empowering students with understanding of the Holy Quran.
        </p>
        <p style="margin-top:10px;">üìç Online Global Platform</p>
      </div>

      <!-- Quick Links -->
      <div style="flex:1 1 180px; min-width:160px;">
        <h4 style="font-weight:600; margin-bottom:15px;">Quick Links</h4>
        <ul style="list-style:none; padding:0;">
          <li><a href="../main pages/html/index.html" style="color:#ccc; text-decoration:none; display:block; padding:6px 0; transition:color 0.3s;">üè† Home</a></li>
          <li><a href="../stories/main.html" style="color:#ccc; text-decoration:none; display:block; padding:6px 0; transition:color 0.3s;">üìñ Prophet Stories</a></li>
          <li><a href="tarjuma.html" style="color:#ccc; text-decoration:none; display:block; padding:6px 0; transition:color 0.3s;">üìú Quran Translation</a></li>
          <li><a href="grammer.html" style="color:#ccc; text-decoration:none; display:block; padding:6px 0; transition:color 0.3s;">üìö Arabic Grammar</a></li>
          <li><a href="../main pages/html/contact.html" style="color:#ccc; text-decoration:none; display:block; padding:6px 0; transition:color 0.3s;">üìû Contact</a></li>
        </ul>
      </div>

      <!-- Contact -->
      <div style="flex:1 1 200px; min-width:180px;">
        <h4 style="font-weight:600; margin-bottom:15px;">Contact</h4>
        <p style="margin:8px 0;">‚úâÔ∏è info@hwquranacademy.com</p>
        <p style="margin:8px 0;">üåê https://hwquranacademy.netlify.app/</p>
      </div>

      
    <!-- Divider -->
    <hr style="border-color:rgba(255,255,255,0.1); margin:30px 0;">

    <!-- Bottom Footer -->
    <div style="text-align:center; color:#777; font-size:14px;">
      ¬© 2025 <strong>Hw Quran Academy</strong> ‚Äî All Rights Reserved | Designed with ‚ù§Ô∏è for Islamic Education
    </div>
  </div>
</footer>
<script src="../auth.js"></script>
<!-- font awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</body>
</html>